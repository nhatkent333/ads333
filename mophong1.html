 <div class="timer">
  <div class="timer-bar"></div>
  <div class="timer-flag"></div>
  <div class="timer-controls">
    <button id="start-btn">Start</button>
    <button id="flag-btn">Flag</button>
  </div>
</div>

<div class="result">
  <p>Score: <span id="score">0</span></p>
  <p>Flagged at: <span id="flag-time">N/A</span></p>
</div>

<style>
	.timer {
  position: relative;
  height: 20px;
  background-color: #ddd;
  margin-bottom: 10px;
}

.timer-bar {
  position: absolute;
  top: 0;
  left: 0;
  width: 0;
  height: 100%;
  background-color: #3498db;
}

.timer-flag {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 2px;
  background-color: #e74c3c;
  display: none;
}

.timer-controls {
  margin-top: 10px;
}

.result {
  margin-top: 20px;
}

.result p {
  margin-bottom: 5px;
}

.result span {
  font-weight: bold;
}

</style>

<script>
	const progressBar = document.querySelector('.timer-bar');
const flagIndicator = document.querySelector('.timer-flag');
const startBtn = document.querySelector('#start-btn');
const flagBtn = document.querySelector('#flag-btn');
const scoreDisplay = document.querySelector('#score');
const flagTimeDisplay = document.querySelector('#flag-time');

let intervalId;
let startTime;
let flagTime;
let score = 0;
let isFlagged = false;

function startTimer() {
  startTime = Date.now();
  flagIndicator.style.display = 'block';
  intervalId = setInterval(updateTimer, 10);
}

function updateTimer() {
  const elapsedTime = Date.now() - startTime;
  const progress = elapsedTime / 15000;
  progressBar.style.width = `${progress * 100}%`;

  if (!isFlagged && elapsedTime >= 5000 && elapsedTime <= 9000) {
    flagBtn.disabled = false;
  }
}

function flagTimer() {
  if (isFlagged) {
    return;
  }
  isFlagged = true;
  flagTime = Date.now() - startTime;

  // Calculate score
  const scorePercentage = 100 - ((flagTime - 5000) / 4000 * 100);
  score = Math.max(0, Math.min(5, Math.round(scorePercentage / 20)));
  scoreDisplay.textContent = score;

  // Display flag time
  const flagTimeSeconds = Math.floor(flagTime / 1000);
  const flagTimeMilliseconds = flagTime % 1000;
  flagTimeDisplay.textContent = `${flagTimeSeconds}.${flagTimeMilliseconds} s`;

  flagBtn.disabled = true;
}

startBtn.addEventListener('click', startTimer);
flagBtn.addEventListener('click', flagTimer);

// Listen for space bar press
document.addEventListener('keydown', function (event) {
  if (!isFlagged && event.code === 'Space') {
    event.preventDefault();
    flagBtn.click();
  }
});

</script>
